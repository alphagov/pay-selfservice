{% extends "../settings-layout.njk" %}

{% set settingsPageTitle = "Ask users for their email address" %}

{% block settingsContent %}
  <h1 class="govuk-heading-l">Ask users for their email address on payment pages</h1>
  <p class="govuk-body">
    Email addresses can be collected on payment pages or collected elsewhere in your service.
    <a class="govuk-link" href="https://docs.payments.service.gov.uk/optional_features/prefill_user_details/"
      >Read about how to prefill payment fields</a
    >
  </p>
  <p class="govuk-body">If you ask for email addresses, users are less likely to encounter a 3D Secure challenge.</p>

  <form id="email-collection-mode" method="post" novalidate>
    <input id="csrf" name="csrfToken" type="hidden" value="{{ csrf }}" />
    {{
      govukRadios({
        idPrefix: 'mode',
        id: 'email-collection-mode',
        name: 'emailCollectionMode',
        fieldset: {
          legend: {
            text: '',
            isPageHeading: true,
            classes: 'govuk-fieldset__legend--l govuk-!-font-weight-bold'
          }
        },
        errorMessage: { text: errors.formErrors['emailCollectionMode'] } if errors.formErrors['emailCollectionMode'] else false,
        items: [
          {
            value: emailCollectionModes.mandatory,
            html: 'On – as a mandatory field',
            label: {
              classes: 'govuk-!-font-weight-bold'
            },
            checked: emailCollectionMode === emailCollectionModes.mandatory,
            hint: {
              text: 'Users must enter an email address to complete a payment – they can receive notifications'
            }
          },
          {
            value: emailCollectionModes.optional,
            html: 'On – as an optional field',
            label: {
              classes: 'govuk-!-font-weight-bold'
            },
            checked: emailCollectionMode === emailCollectionModes.optional,
            hint: {
              text: 'Users can choose to enter an email address – if they do, they can receive notifications'
            }
          },
          {
            value: emailCollectionModes.no,
            html: 'Off',
            label: {
            classes: 'govuk-!-font-weight-bold'
          },
            checked: emailCollectionMode === emailCollectionModes.no,
            hint: {
              text: 'Users do not have the option to enter an email address – they will not receive notifications'
            }
          }
        ]
      })
    }}
    {{
      govukButton({
        text: 'Save changes'
      })
    }}
  </form>
{% endblock %}
