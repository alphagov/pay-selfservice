{% extends "simplified-account/services/service-layout.njk" %}
{% from "govuk/components/table/macro.njk" import govukTable %}


{% set servicePageTitle %}
  Transaction details {{ transaction.externalId }}
{% endset %}

{% block serviceContent %}
  {% for sectionKey, sectionData in transaction %}

    {% if (loop.first == true) %}
      <h1 class="govuk-heading-l">{{ sectionKey }}</h1>
    {% else %}
      <h2 class="govuk-heading-m">{{ sectionKey }}</h2>
    {% endif %}

    {% set rows = [] %}
    {% for key, value in sectionData %}
      {% if value %}
        {%
          set rows = (rows.push({
            key: {
              text: key
            },
            value: {
              text: value
            }
          }), rows)
        %}
      {% endif %}
    {% endfor %}

    {{ govukSummaryList({ rows: rows }) }}
  {% endfor %}

  {% set eventsTableRows = [] %}
  {% for eventKey, eventData in events %}
    {%
      set eventsTableRows = (eventsTableRows.push([
        {
          text: eventData.description
        },
        {
          text: eventData.formattedAmount,
          format: "numeric"
        },
        {
          text: eventData.timestamp
        }
      ]), eventsTableRows)
    %}
  {% endfor %}

  {{
    govukTable({
      caption: "Transaction events",
      captionClasses: "govuk-table__caption--m",
      firstCellIsHeader: true,
      rows: eventsTableRows
    })
  }}

  <!--{{ events | dump }}
  <hr />

  {{ transaction | dump }}
  <hr />
  {{ data | dump }}-->
{% endblock %}
