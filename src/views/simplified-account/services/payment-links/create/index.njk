{% extends "simplified-account/services/service-layout.njk" %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/textarea/macro.njk" import govukTextarea %}
{% from "govuk/components/radios/macro.njk" import govukRadios %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/inset-text/macro.njk" import govukInsetText %}
{% from "govuk/components/warning-text/macro.njk" import govukWarningText %}

{% set servicePageTitle = "Enter test payment link details" %}

{% block serviceContent %}
  <h1 class="govuk-heading-l">{{ servicePageTitle }}</h1>

  <form method="post" novalidate>
    <input id="csrf" name="csrfToken" type="hidden" value="{{csrf}}"/>

    {{ govukInput({
      label: {
        text: "Title",
        classes: "govuk-label--m"
      },
      hint: {
        text: "For example, 'Pay for your registration on the Register of Overseas Entities'."
      },
      id: "name",
      name: "name",
      value: formValues.name,
      classes: "govuk-!-width-two-thirds",
      errorMessage: { text: errors.formErrors['name'] } if errors.formErrors['name'] else false
    }) }}

    {{ govukTextarea({
      label: {
        text: "Details (optional)",
        classes: "govuk-label--m"
      },
      hint: {
        text: "Give your users more information. For example, you could tell them how long it takes for their application to be processed."
      },
      id: "description",
      name: "description",
      value: formValues.description,
      classes: "govuk-!-width-two-thirds",
      rows: 3,
      errorMessage: { text: errors.formErrors['description'] } if errors.formErrors['description'] else false
    }) }}

    {{ govukRadios({
      idPrefix: "reference",
      name: "reference",
      fieldset: {
        legend: {
          text: "Will your users already have a payment reference?",
          classes: "govuk-fieldset__legend--m"
        }
      },
      hint: {
        text: "You can use numbers or words in your payment reference. For example, you can include the applicant's name or an existing reference number."
      },
      items: [
        {
          value: "yes",
          text: "Yes",
          checked: formValues.reference === "yes",
          conditional: {
            html: govukInput({
              label: {
                text: "Name of reference column"
              },
              hint: {
                text: "For example, 'Invoice number'"
              },
              id: "reference-label",
              name: "referenceLabel",
              value: formValues.referenceLabel,
              classes: "govuk-!-width-two-thirds",
              errorMessage: { text: errors.formErrors['referenceLabel'] } if errors.formErrors['referenceLabel'] else false
            }) +
            govukTextarea({
              label: {
                text: "Hint text for users (optional)"
              },
              hint: {
                text: "Tell users what the reference column is for."
              },
              id: "reference-hint",
              name: "referenceHint",
              value: formValues.referenceHint,
              classes: "govuk-!-width-two-thirds",
              rows: 2,
              errorMessage: { text: errors.formErrors['referenceHint'] } if errors.formErrors['referenceHint'] else false
            })
          }
        },
        {
          value: "no",
          text: "No - use a reference generated by GOV.UK Pay",
          checked: formValues.reference === "no" or not formValues.reference
        }
      ],
      errorMessage: { text: errors.formErrors['reference'] } if errors.formErrors['reference'] else false
    }) }}

    {{ govukRadios({
      idPrefix: "amount-type",
      name: "amountType",
      fieldset: {
        legend: {
          text: "Is the payment for a fixed amount?",
          classes: "govuk-fieldset__legend--m"
        }
      },
      items: [
        {
          value: "fixed",
          text: "Yes",
          checked: formValues.amountType === "fixed",
          conditional: {
            html: govukInput({
              label: {
                text: "Enter the amount"
              },
              hint: {
                text: "Enter the amount in pounds and pence, for example 23.45"
              },
              id: "amount",
              name: "amount",
              value: formValues.amount,
              classes: "govuk-input--width-10",
              prefix: {
                text: "Â£"
              },
              spellcheck: false,
              errorMessage: { text: errors.formErrors['amount'] } if errors.formErrors['amount'] else false
            })
          }
        },
        {
          value: "variable",
          text: "No , the user can choose the amount",
          checked: formValues.amountType === "variable",
          conditional: {
            html: govukTextarea({
              label: {
                text: "Hint text for users (optional)"
              },
              hint: {
                text: "Give users more information about the amount they need to pay."
              },
              id: "amount-hint",
              name: "amountHint",
              value: formValues.amountHint,
              classes: "govuk-!-width-two-thirds",
              rows: 2,
              errorMessage: { text: errors.formErrors['amountHint'] } if errors.formErrors['amountHint'] else false
            })
          }
        }
      ],
      errorMessage: { text: errors.formErrors['amountType'] } if errors.formErrors['amountType'] else false
    }) }}

    {{ govukButton({
      text: "Continue",
      classes: "govuk-!-margin-top-6"
    }) }}

    <p class="govuk-body">
      <a href="{{ backLink }}" class="govuk-link govuk-link--no-visited-state">Cancel</a>
    </p>
  </form>
{% endblock %}
