{% extends "../settings-layout.njk" %}

{% block settingsPageTitle %}
  Stripe details
{% endblock %}

{% macro stripeTask(key, value) %}
  <li class="govuk-task-list__item {% if value.status == false %}govuk-task-list__item--with-link{% endif %}">
    {% if value.status == false %}
      <div class="govuk-task-list__name-and-hint">
        <a class="govuk-link govuk-task-list__link govuk-link--no-visited-state" href="{{ value.href }}"
           aria-describedby="{{ value.id }}">
          {{ key }}
        </a>
      </div>
    {% else %}
      {{ key }}
    {% endif %}
    <div class="govuk-task-list__status" id="{{ value.id }}">
      {% if value.status == 'disabled' %}
        <strong class="govuk-tag govuk-tag--grey">
          Cannot start yet
        </strong>
      {% elseif value.status == true %}
        <strong class="govuk-tag">
          Completed
        </strong>
      {% else %}
        <strong class="govuk-tag govuk-tag--blue">
          Not yet started
        </strong>
      {% endif %}
    </div>
  </li>
{% endmacro %}

{% block settingsContent %}
  <h1 class="govuk-heading-l">Stripe details</h1>
  {% if incompleteTasks %}
    <p class="govuk-body govuk-!-font-weight-bold">Add your organisation's details</p>
    <ul class="govuk-task-list">
      {% for key, value in stripeDetailsTasks %}
        {{ stripeTask(key, value) }}
      {% endfor %}
    </ul>
  {% else %}
    <p class="govuk-body">This information has been sent to Stripe so that your service can take payments. For security
      reasons we cannot show all the information submitted to Stripe.</p>

    <p class="govuk-body">If you need to change these details or upload another Government Entity document, <a
        class="govuk-link govuk-link--no-visited-state"
        href="mailto:govuk-pay-support@digital.cabinet-office.gov.uk?subject=Change request - Stripe details [service external id: {{ serviceExternalId }}]">contact
        GOV.UK Pay</a></p>

    {{ govukSummaryList({
      card: {
        title: {
          text: "Organisation bank details"
        }
      },
      rows: [
        {
          key: {
          text: "Sort code"
        },
          value: {
          text: answers.bankAccount.sortCode
        }
        },
        {
          key: {
          text: "Account number"
        },
          value: {
          text: answers.bankAccount.accountNumber
        }
        }
      ]
    }) }}

    {{ govukSummaryList({
      card: {
        title: {
          text: "Organisation contact"
        }
      },
      rows: [
        {
          key: {
          text: "Responsible person"
        },
          value: {
          text: answers.responsiblePerson
        }
        },
        {
          key: {
          text: "Service director"
        },
          value: {
          text: answers.director
        }
        }
      ]
    }) }}

    {{ govukSummaryList({
      card: {
        title: {
          text: "Company registration details"
        }
      },
      rows: [
        {
          key: {
          text: "VAT registration number"
        },
          value: {
          text: answers.company.vatNumber
        }
        },
        {
          key: {
          text: "Company registration number"
        },
          value: {
          text: answers.company.companyNumber
        }
        },
        {
          key: {
          text: "Government entity document"
        },
          value: {
          text: answers.company.entityDocument
        }
        }
      ]
    }) }}
  {% endif %}

{% endblock %}
